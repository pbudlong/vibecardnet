# Concepts: Understanding Gasless Payments

This SDK enables you to add micropayments to your API without forcing buyers to pay gas fees for every request.

## The Challenge: Micropayments on Blockchain

Blockchains allow for the transfer of value at scales rarely seen in the fiat world. USDC, for example, supports transactions as small as $0.000001 (6 decimals).

However, settling these tiny amounts directly on-chain creates an economic problem: **Gas Fees**.

1.  **Disproportionate Cost**: If a transaction is $0.01 but gas costs $0.005 (or even $0.001), the fees are a massive percentage of the value transferred.
2.  **Friction**: For high-frequency use cases (like AI agents paying per query or gamers buying items), signing and broadcasting a transaction for every interaction is slow and inefficient.

**Result:** Micropayments become impractical on-chain, even if the token supports them.

## The Solution: x402 + Circle Gateway

We solve this by moving the high-frequency activity off-chain while keeping settlement on-chain.

1.  **Buyer Requests**: A user or AI agent requests a paid resource.
2.  **Instant Signing**: The buyer signs a message authorizing payment. This is instant and free (zero gas).
3.  **Immediate Access**: The API verifies the signature locally and serves the content immediately.
4.  **Batched Settlement**: Circle Gateway collects these signatures and settles them in bulk on-chain later.

## How it Works

The flow uses standard HTTP error codes (`402 Payment Required`) to negotiate payment.

```text
       BUYER (User/Agent)                    SELLER (API)
            |                                     |
            |   1. GET /premium-resource          |
            |------------------------------------>|
            |                                     |
            |   2. 402 Payment Required           |
            |   (Price: 0.01 USDC)                |
            |<------------------------------------|
            |                                     |
    [Signs Message]                               |
            |                                     |
            |   3. GET /premium-resource          |
            |   Header: Payment-Signature         |
            |------------------------------------>|
            |                                     |
            |        [Verifies Signature]         |
            |                                     |
            |   4. 200 OK (Content)               |
            |<------------------------------------|
            |                                     |
                                                  |    (Later)
                                                  |-------+
                                                  |       |
                                                  v       |
                                            [Circle Gateway]
                                            (Settles Funds)
```

## Key Terms

| Term               | Definition                                                                                    |
| ------------------ | --------------------------------------------------------------------------------------------- |
| **Gateway Wallet** | A smart contract where Buyers deposit USDC. This balance is used to pay for things gaslessly. |
| **Burn Intent**    | The "check" the buyer signs. It authorizes Gateway to burn their deposited USDC.              |
| **Batching**       | The process of grouping many Burn Intents together to settle them efficiently.                |

## Lifecycle of a Payment

1.  **Deposit**: The Buyer moves USDC from their personal wallet into the Gateway Wallet. This is a one-time on-chain transaction.
2.  **Spend**: The Buyer spends this balance by signing messages. These are off-chain and free.
3.  **Settle**: Gateway aggregates these signatures and performs an on-chain transfer directly into the Seller's Gateway Balance.
4.  **Withdraw (Liquidity)**: The Seller receives the funds in their Gateway Balance. They can now instantly withdraw this balance to their regular wallet on any Gateway-supported chain, enabling instant cross-chain liquidity.
